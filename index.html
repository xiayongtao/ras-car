<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>树莓派遥控小车</title>
    <!-- 最新版本的 Bootstrap 核心 CSS 文件 -->
    <link rel="stylesheet" href="./static/bootstrap.min.css" rel="stylesheet" media="screen">
    <script src="./static/jquery-3.5.1.min.js"></script>
    <script src="./static/bootstrap.min.js"></script>
    <style type="text/css">
        #up {
            margin-left: 55px;
            margin-bottom: 3px;
        }

        #down {
            margin-top: 3px;
            margin-left: 55px;
        }

        img {
            width: auto;
            height: auto;
            max-width: 100%;
            max-height: 100%;
        }
    </style>
    <script>
        $(function () {

            function down(id) {
                console.log("鼠标按下:" + id)
                $.post("/cmd", id, function (data, status) {
                }).fail(function (response) {
                    console.log("鼠标按下失败:" + JSON.stringify(response))
                });
            }

            function up(id) {
                console.log("鼠标抬起:" + id)
                $.post("/cmd", 'stop', function (data, status) {
                }).fail(function (response) {
                    console.log("鼠标抬起失败:" + JSON.stringify(response))
                });
            }

            $(".btn").mousedown(function () {
                down(this.id)
            });

            $(".btn").mouseup(function () {
                up(this.id)
            });

            $(".btn").bind("touchstart", function (e) {
                console.log(e.touches);    //手指坐标
                down(this.id)
            });

            $(".btn").bind("touchend", function (e) {
                console.log(e.touches);    //手指坐标
                up(this.id)
            });

            $(".btnStop").click(function () {
                console.log("停车:" + this.id)
                $.post("/cmd", this.id, function (data, status) {
                }).fail(function (response) {
                    console.log("停车失败:" + JSON.stringify(response))
                });
            });


            $(".btnVideo").click(function (data, status) {
                console.log("打开视频:" + this.id)
                $.post("/cmd", this.id, function (data, status) {
                    if (this.id === 'video_play') {
                        $("#btnVideo").attr("disabled", "disabled");
                        //$("#img").attr("src", "http://192.168.31.16:8888/?action=stream");
                    } else {
                        $("#btnVideo").attr("disabled", "");
                        //  ("#img").attr("src", "");
                    }
                }).fail(function (response) {
                    $("#btnVideo").attr("disabled", "");
                    console.log("打开失败:" + JSON.stringify(response))
                    //("#img").attr("src", "");
                });
            })
        });
    </script>
</head>
<body>
<div id="container" class="container">
    <div>
        <button id="up" class="btn btn-lg btn-primary glyphicon glyphicon-circle-arrow-up"></button>
    </div>
    <div>
        <button id='left' class="btn btn-lg btn-primary glyphicon glyphicon-circle-arrow-left"></button>
        <button id='stop' class="btnStop btn-lg btn-primary glyphicon glyphicon-stop"></button>
        <button id='right' class="btn btn-lg btn-primary glyphicon glyphicon-circle-arrow-right"></button>
    </div>
    <div>
        <button id='down' class="btn btn-lg btn-primary glyphicon glyphicon-circle-arrow-down"></button>
    </div>

    <div>
        <button id="video_play" class="btnVideo btn-lg btn-primary glyphicon glyphicon-play-circle"></button>
        <button id="video_stop" class="btnVideo btn-lg btn-primary glyphicon glyphicon-stop"></button>
        <img src="http://192.168.31.16:8888/?action=stream"/>
    </div>

</div>

</body>
</html>
